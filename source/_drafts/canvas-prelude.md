---
title: ক্যানভাস, ক্যারেক্টার ও মুভমেন্ট
categories: 
    - [ক্যানভাস]
---
## সূচনা
আমি ক্যানভাস টিউটোরিয়াল দেখে নিজে নিজে একটা গেম বানানোর চেষ্টা করলেও মুভমেন্ট লজিক সম্পর্কে কেমন যেন অস্পষ্ট ধারণা থেকে যাচ্ছে। সেটা দূর করার জন্যই আলাদা ভাবে শুধু মুভমেন্ট লজিকটা বুঝে নেয়ার সিদ্ধান্ত নিয়েছি। এই নোটে সেটাই থাকবে।

## প্রাথমিক সেটআপ
ক্যানভাস নিয়ে কাজ করতে হলে তো আমার পেজে সেটা থাকতেই হবে, তাই না? আগে পেজে ক্যানভাসটা এড করে নিই।

```html
<canvas id="canvas"></canvas>
```

### পেজ থেকে ক্যানভাস আলাদা করা
সমস্যা হচ্ছে আমার পেজের কোন ব্যাকগ্রাউন্ড নাই, আর ক্যানভাসেরও নাই। তাই কোনটা কী বুঝা যাচ্ছে না।

সিম্পল দুইটা সিএসএস রুল দিয়ে এটা সলভ করে ফেলা যায়। একটাতে ক্যানভাসের জন্যে আর আরেকটাতে পেজের ব্যাকগ্রাউন্ড সেট করে নিলাম।

### ক্যানভাসের কনটেক্সট নেয়া
এবারে স্ক্রিপ্টে আমরা ক্যানভাসটাকে সিলেক্ট করি -
```
const canvas =  document.getElementById('#canvas');
```
তারপরে যেটা করতে হবে সেটা মনে রাখায় আমার খানিকতা সমস্যা হইছে, এখনো হয়। তার উপর আবার ভিএস কোডে ক্যানভাসের কোড অটোকমপ্লিট আসতেছে না। তো ভুল হলে বুঝার উপায় নাই। 

ক্যানভাসে আমরা হাতি ঘোড়া যাই আঁকি, সেগুলো কিন্তু অমনি অমনি হয়ে যাবে না। সেগুলোর জন্য বৃত্ত, চতুর্ভুজ, অর্ধবৃত্তের মত উপাদানগুলা লাগবে। সেগুলার একটা সংগ্রহ আছে, সেইটা হচ্ছে 2d context.
```
const canvasContext = canvas.getContext('2d');
```

### ক্যানভাসের দৈর্ঘ্য প্রস্থ সেট করা
ক্যানভাসের দৈর্ঘ্য আর প্রস্থটা চাইলে এইচটিএমএল পেজে সেট করে নিতে পারতাম, তবে তার বদলে স্ক্রিপ্টে সেট করাটাই সুবিধাজনক মনে হইছে আমার। আবার তারচেয়ে ভালো হয় সিএসএস রুলসে এড করে নিলে।
```
canvas.width = 400;
canvas.height = 400;
```

এইখানেই মোটামুটি সেটআপ শেষ।

## ক্যানভাসের জন্যে ইমেজ যুক্ত করা
সিম্পলি যে ইমেজটা ক্যানভাসে বসাবো, সেটাকে সাধারণ ইমেজ ট্যাগের মাধ্যমে পেজে এড করি। ইমেজটা ছোট আকারের আর ট্রান্সপারেন্ট ব্যাকগ্রাউন্ডের হইলে ভালো।

```
<img src="https://i.ibb.co/HHBFJdH/char.png" id="character" alt="">
```

এখন পেজে গেলে দেখা যাবে, সেটা ক্যানভাসে না এসে বরং ক্যানভাসের পাশে ফুল সাইজে আসছে। আমি সেটার সাইজ সিএসএস রুলে সেট করে দিয়ে ডিসপ্লে none করে দেয়ার পরে অবশ্য আর দেখাবে না। এখন এটা আমাদের ক্যানভাসের মধ্যে নেয়া যায়।

## ক্যানভাসে স্থানাংক/অবস্থান
ক্যানভাসের একদম বামের উপরের কোণাটা হচ্ছে (০,০)। এইটা একটু অড। কারণ আমরা সারা জীবন দেখে আসছি একেবারে মাঝখানে (০,০)(আমার স্থানাংকটা বার বার ইমো হয়ে যাচ্ছে)।

```javascript
canvasContext.drawImage(charImage, 10, canvas.height-30,25,20);
```
ক্যানভাসের এই একটা দিক অতি ভালো। আমি চাইলেই ক্যানভাসের দৈর্ঘ্য ও প্রস্থ canvas.height আর canvas.width-এর মাধ্যমে বের করে ফেলতে পারি। এখানে ক্যানভাস ছোট আর বড় করা হোক, ক্যারেক্টারটা সব সময়ই ক্যানভাসের নিচের দিক থেকে খানিকটা উপরে থাকবে।

## সমস্যার আছর
আমি যখন প্রথম বার drawImage() কল করলাম, আমার ক্যানভাসে ক্যারেক্টারটা আসেনি। আমি ভাবলাম, কী হলো আবার! সব কিছু চেক করেও ঝামেলা বুঝতে পারছিলাম না।

নেট ঘেঁটে বুঝতে পারলাম যে, আমার মূল ফাইলটাতে ক্যানভাস আগে যুক্ত করেছি, তারপরে ছবি যুক্ত করে সেটাকে ক্যানভাসে নিয়েছি; ফলে ক্যানভাস যখন ইমেজ চাচ্ছে, ইমেজ তখনই লোডই হয় নাই!!! কি বিপদ!!

তবে সবখানে এই সমস্যাটা হবে না মনে হয়। সে যেমনই হোক, সমাধান সহজ। ইমেজে একটা ইভেন্ট লিসেনার লাগাও, যে টিকটিকির মত ইমেজ লোড হলে সংবাদটা ক্যানভাসকে বলে দিবে। 


## সমস্যা ২
আমি ইমেজের সোর্সটা বদলে যখন আবার অনলাইন সোর্স এড করলাম, তখন এটাই আমাকে সমস্যা দিতে শুরু করলো, মানে ইভেন্ট লিসেনারটা। তাই ইভেন্ট লিসেনার বাদ। আগে কেন ইভেন্ট লিসেনার দেয়ায় সমস্যা সল্ভ হলো আর পরে অফলাইন বাদ দিয়ে অনলাইন ইমেজ যুক্ত করার পর সমস্যা হাজির হলো, এটা নিয়ে পরে বিস্তারিত দেখতে হবে।

## সমস্যা ৩
ক্যানভাসের দৈর্ঘ্য ও প্রস্থ সিএসএস রুলস হিসেবে দেওয়া থাকায় আমার ইমেজটার আকার একদম না কমিয়ে আনলে (২৫,২০) সেটা খুব বড় দেখাচ্ছিলো আবার একদম কমানোয় তা ঝাপসা দেখাচ্ছিলো।

ক্যানভাসের সিএসএস রুল বাদ দিয়ে এইচটিএমএল ট্যাগে প্রোপার্টি হিসেবে দৈর্ঘ্য ও প্রস্থ দেয়ার পর তা আর হচ্ছিলো না।

ফলে আমার ইমেজটা স্পষ্ট ভাবে যুক্ত করা সম্ভব হয়েছে। 

```
canvasContext.drawImage(charImage, 10, (canvas.height/2)-35, 50,60);
```

## এনিমেশনের বেসিক 
![ফ্লিপবুক](https://media3.giphy.com/media/TgF6DR3MDcOn1KZXlL/giphy.gif?cid=ecf05e4743aaf59abebd54bf6da75d299cd784c5105d8870&rid=giphy.gif)

ধরি আমাদের ক্যারেক্টারটা বাম থেকে ডানে যাবে।

আমরা তাইলে যা করবো, 



### ক্যানভাস মুছা
